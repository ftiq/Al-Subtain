<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="project_task_view_form_inherit_forms" model="ir.ui.view">
        <field name="name">project.task.form.inherit.fsm.forms</field>
        <field name="model">project.task</field>
        <field name="inherit_id" ref="project.view_task_form2"/>
        <field name="arch" type="xml">
            <xpath expr="//notebook/page[1]" position="before">
                <page string="ุงูููุงุฐุฌ" name="fsm_forms" invisible="total_samples_count == 0" groups="industry_fsm.group_fsm_user">
                    <field name="form_line_ids" nolabel="1" options="{'limit': 1}" invisible="stock_receipt_id and has_concrete_product">
                        <list editable="bottom" string="ุงููููุฐุฌ">
                            <field name="product_id" string="ุงูููุชุฌ" 
                                   options="{'no_create': True}" 
                                   domain="[('is_sample_product', '=', True)]"/>

                            <field name="quantity" string="ุงููููุฉ"/>
                            <button name="open_move" type="object" class="btn btn-link" icon="fa-bars" string="ุนุฑุถ ุงูุญุฑูุฉ"/>
                        </list>
                    </field>
                    

                    <div class="mt-4">
                        <separator string="ุงูุฃุณุฆูุฉ" class="mt-4"/>
                        <button name="%(action_project_task_signature_wizard)d" type="action" string="ุงูุชูููุน" class="btn btn-primary mb-2 oe_highlight" invisible="1"/>
                        <field name="fsm_signature" widget="signature" readonly="1" class="mb-2" invisible="1"/>
                        <field name="fsm_question_ids" nolabel="1">
                            <list editable="bottom" string="ุงูุฃุณุฆูุฉ">
                                <field name="question_id" string="ุงูุณุคุงู"/>
                                <field name="value_answer_id" string="ุงูุฅุฌุงุจุฉ ุงููุฎุชุงุฑุฉ"/>
                                <field name="value_text_box" string="ุฅุฌุงุจุฉ ูุตูุฉ"/>
                            </list>
                            <form string="ุณุคุงู">
                                <group>
                                    <field name="question_id" string="ุงูุณุคุงู" readonly="1"/>
                                    <field name="value_answer_id" string="ุงูุฅุฌุงุจุฉ ุงููุฎุชุงุฑุฉ" readonly="1"/>
                                    <field name="value_text_box" string="ุฅุฌุงุจุฉ ูุตูุฉ" readonly="1"/>
                                </group>
                            </form>
                        </field>
                    </div>
                    

                    <div class="mt-4">
                        <separator string="ุงูุฎุฏูุงุช" class="mt-4"/>
                        <field name="service_line_ids" nolabel="1">
                            <list editable="bottom" string="ุงูุฎุฏูุงุช">
                                <field name="product_id" string="ุงูููุชุฌ" options="{'no_create': True}"/>
                                <field name="quantity" string="ุงููููุฉ"/>
                                <field name="price_unit" string="ุณุนุฑ ุงููุญุฏุฉ" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                <field name="price_subtotal" string="ุงูุฅุฌูุงูู" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                            </list>
                        </field>
                    </div>
                    
         

                    <div class="mt-4" invisible="not stock_receipt_id or not has_concrete_product">
                        <div class="alert alert-info" role="alert" invisible="stock_receipt_id">
                            <p><strong>ููุงุญุธุฉ:</strong> ูุฌุจ ุญูุธ ุงููููุฉ ุฃููุงู ูุฅูุดุงุก ุณุฌู ุงูุนููุงุช</p>
                        </div>
                        
                        <div class="alert alert-warning" role="alert" invisible="stock_receipt_id or has_concrete_product">
                            <p><strong>ุชูุจูู:</strong> ูู ูุชู ุงุฎุชูุงุฑ ุฃู ููุชุฌ ูู ููุน ุงูุฎุฑุณุงูุฉ. ูู ุจุฅุถุงูุฉ ููุชุฌ ุฎุฑุณุงูุฉ ูู ุฌุฏูู ุงูููุชุฌุงุช ุฃุนูุงู.</p>
                        </div>
                        
                        <div invisible="not stock_receipt_id or not has_concrete_product">
                            <separator string="ุนููุงุช ุงูุฎุฑุณุงูุฉ" class="mt-4"/>
                            
                            <div class="alert alert-warning" invisible="not is_signed">
                                <strong>ุชู ููู ุฅุนุฏุงุฏุงุช ุงูุนููุงุช</strong><br/>
                                ูุง ูููู ุชุนุฏูู ุฅุนุฏุงุฏุงุช ุนููุงุช ุงูุฎุฑุณุงูุฉ ุจุนุฏ ุงูุชูููุน ุงูุฅููุชุฑููู ุนูู ุญุฑูุฉ ุงููุฎุฒูู.
                            </div>
                            
                            <group>
                                <group string="ูุนูููุงุช ุงูุฎุฑุณุงูุฉ">
                                    <field name="planned_concrete_m3" string="ูููุฉ ุงูุฎุฑุณุงูุฉ (mยณ)" widget="float" readonly="is_signed"/>
                                    <field name="concrete_sample_type_id" string="ุงูููุน" domain="[('code', 'in', ['CONCRETE_BUILDINGS', 'CONCRETE_FOUNDATIONS', 'CONCRETE_BRIDGES'])]" readonly="is_signed"/>
                                    <!--<field name="sample_type_id" string="Sample Type" readonly="1" invisible="not sample_type_id"/>-->
                                    <!--<field name="enable_reserve_samples" string="ุชูุนูู ุงูุนููุงุช ุงูุงุญุชูุงุทูุฉ" widget="boolean_toggle" readonly="is_signed"/>-->
                                    <field name="concrete_sample_subtype_id" invisible="1"/>
                                </group>
                                    <group string="ุงููุนูุงุฑ ุงููุฑุฌุนู">
                                    <field name="reference_general_limit" string="ุงููุนูุงุฑ" readonly="is_signed"/>

                                </group>
                                <!--
                                <group string="ุงูุนููุงุช ุงูููุฏุฑุฉ">
                                    <field name="estimated_samples" string="ุงูุนููุงุช ุงูููุฏุฑุฉ" invisible="state in ['done', 'cancel']"/>
                                    <field name="estimated_cubes" string="ุงูููุนุจุงุช ุงูููุฏุฑุฉ" invisible="state in ['done', 'cancel']"/>
                                    <field name="enable_7_days_samples" string="ุชูุนูู ุนููุงุช 7 ุฃูุงู" widget="boolean_toggle" readonly="is_signed"/>
                                    <field name="seven_days_for_all_groups" string="7 ุฃูุงู ููู ุงููุฌููุนุงุช" widget="boolean_toggle" invisible="not enable_7_days_samples" readonly="is_signed"/>
                                    <field name="reserve_for_all_groups" string="ุงุญุชูุงุท ููู ุงููุฌููุนุงุช" widget="boolean_toggle" invisible="not enable_reserve_samples" readonly="is_signed"/>
                                </group>
                                -->
                            </group>
                            
                            <group>

                            </group>
                            <!--
                            
                            <div class="text-center mb-3">

                                <button name="action_recalculate_samples" type="object" 
                                        string="๐ค ุญุณุงุจ ุงูุนููุงุช ุชููุงุฆูุงู" 
                                        class="btn btn-primary me-2" 
                                        icon="fa-refresh"
                                        invisible="not auto_sample_generation or not planned_concrete_m3 or not concrete_sample_type_id or is_signed"/>
                                

                                <button name="action_add_manual_sample" type="object" 
                                        string="โ ุฅุถุงูุฉ ุนููุฉ ูุฏููุงู" 
                                        class="btn btn-success me-2" 
                                        icon="fa-plus"
                                        invisible="auto_sample_generation or is_signed"/>
                                

                                <button name="action_generate_codes" type="object" 
                                        string="๐ง ุชูููุฏ ุฑููุฒ ููุนููุงุช ุงูููุฌูุฏุฉ" 
                                        class="btn btn-info me-2" 
                                        icon="fa-magic"
                                        invisible="auto_sample_generation or not move_line_ids or is_signed"/>
                                

                                <button name="action_clear_samples" type="object" 
                                        string="๐๏ธ ูุณุญ ุฌููุน ุงูุนููุงุช" 
                                        class="btn btn-warning" 
                                        icon="fa-trash"
                                        invisible="not move_line_ids or is_signed"
                                        confirm="ูู ุชุฑูุฏ ุญุฐู ุฌููุน ุงูุนููุงุช ุงูููุฌูุฏุฉุ"/>
                            </div>
                            -->
                            <field name="move_line_ids" string="ุฎุทูุท ุงูุนููุงุช" options="{'no_open': True}">
                                <list string="ุชูุงุตูู ุงูุนููุงุช"
                                      editable="bottom"
                                      create="not is_signed"
                                      delete="not is_signed"
                                      edit="not is_signed"
                                      no_open="1">
                                    <!-- ุงูุญููู ุงููุทููุจุฉ ุงููุฎููุฉ -->
                                    <field name="move_id" column_invisible="True"/>
                                    <field name="product_id" column_invisible="True"/>
                                    <field name="product_uom_id" column_invisible="True"/>
                                    <field name="location_id" column_invisible="True"/>
                                    <field name="location_dest_id" column_invisible="True"/>
                                    
                                    <!-- ุงูุญููู ุงููุฑุฆูุฉ -->
                                    <field name="group_no" string="ุงููุฌููุนุฉ"/>
                                    <field name="field_code" string="ุงูุฑูุฒ ุงููุฎุชุจุฑู" 
                                           placeholder="ุณูุชู ุงูุชูููุฏ ุญุณุจ ุงูุฅุนุฏุงุฏุงุช"/>
                                    <field name="field_serial" string="ุงูุฑูุฒ ุงูุญููู" 
                                           placeholder="ุณูุชู ุงูุชูููุฏ ุญุณุจ ุงูุฅุนุฏุงุฏุงุช"/>
                                    <field name="age_days" string="ุงูุฃูุงู" optional="show"/>
                                    <field name="cube_count" string="ุนุฏุฏ ุงูููุนุจุงุช"/>
                                </list>
                            </field>
                        </div>
                    </div>
                </page>
            </xpath>
        </field>
    </record>
    

    <record id="project_task_view_form_samples_count" model="ir.ui.view">
        <field name="name">project.task.form.samples.count</field>
        <field name="model">project.task</field>
        <field name="inherit_id" ref="project.view_task_form2"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='user_ids']" position="after">
                <field name="total_samples_count" string="ุงูุนุฏุฏ ุงูููู ููุนููุงุช" 
                       invisible="not is_fsm" groups="industry_fsm.group_fsm_user"/>
                <field name="main_sample_subtype_id" string="ุงูููุน ุงููุฑุนู" 
                       invisible="not is_fsm or not main_sample_is_masonry"
                       domain="[('sample_type_id.code', '=', 'MASONRY')]" groups="industry_fsm.group_fsm_user"/>
            </xpath>
        </field>
    </record>
    

    <record id="project_task_view_form_book_fields" model="ir.ui.view">
        <field name="name">project.task.form.book.fields</field>
        <field name="model">project.task</field>
        <field name="inherit_id" ref="project.view_task_form2"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='tag_ids']" position="after">
                <field name="book_number" string="ุฑูู ุงููุชุงุจ" invisible="not is_fsm" groups="industry_fsm.group_fsm_user"/>
                <field name="book_date" string="ุชุงุฑูุฎ ุงููุชุงุจ" invisible="not is_fsm" groups="industry_fsm.group_fsm_user"/>
                <field name="modeling_date" string="ุชุงุฑูุฎ ุงูููุฐุฌุฉ" invisible="not is_fsm" groups="industry_fsm.group_fsm_user"/>
                <field name="book_notes" string="ุงูููุงุญุธุงุช" widget="html" placeholder="ุฃุฏุฎู ุงูููุงุญุธุงุช ููุง..." nolabel="0" groups="industry_fsm.group_fsm_user"/>
            </xpath>
        </field>
    </record>
</odoo> 